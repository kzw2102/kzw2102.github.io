---
title: "Problem 2 Dashboard"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)

library(tidyverse)
library(viridis)
library(p8105.datasets)

library(plotly)
```
```{r}
data(rest_inspec)

#tidy
rest_inspec_tidy=
  rest_inspec %>% 
  select(
    boro, zipcode, dba, cuisine_description, building, grade, score
  ) %>% 
  filter(
    !is.na(grade),
    grade %in% c("A", "B", "C", "Not Yet Graded"),
    cuisine_description == c("Korean", "Chinese", "American", "Donuts")
  ) %>% 
  mutate(
    grade=as.factor(grade),
    grade=fct_relevel(grade, c("A", "B", "C", "Not Yet Graded"))
  )
```
```

Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r}
rest_inspec_tidy %>% 
  plot_ly(x=~score, y=~boro, type="scatter", mode="markers", color=~grade, alpha=0.5 )
  
```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}
rest_inspec_tidy%>% 
  filter(boro=="MANHATTAN") %>% 
  count(cuisine_description) %>% 
  mutate(cuisine_description = fct_reorder(cuisine_description, n)) %>% 
  plot_ly(x= ~cuisine_description, y= ~n, color = ~cuisine_description, type="bar")
```

### Chart C

```{r}
box_ggplot=
  rest_inspec_tidy%>% 
  mutate(grade = fct_reorder(grade, score)) %>% 
  ggplot(aes(x=grade, y=score, fill= cuisine_description)) +
  geom_boxplot()+
  theme_classic () +
  theme(axis.text.x = element_text(angle=90, hjust=1))

ggplotly(box_ggplot)
```

